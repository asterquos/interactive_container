# 集装箱装载管理系统需求分析报告

## 1. 项目概述

### 1.1 项目背景
本项目旨在开发一个具有图形用户界面的Python应用程序，用于优化集装箱装载过程。该系统将帮助用户合理安排货物在集装箱中的位置，确保重量分布均衡，提高空间利用率。

### 1.2 项目目标
- 提供直观的可视化界面进行集装箱装载规划
- 实现重量平衡自动检测和提醒
- 优化空间利用率
- 支持多集装箱管理
- 生成专业的装载报告

## 2. 功能需求分析

### 2.1 数据导入功能
#### 2.1.1 Excel文件上传
- 支持.xlsx和.xls格式
- 支持多工作表（Sheet）处理
- 必需字段：箱号（ID）、长度、宽度、重量
- 数据验证：检查必需字段完整性和数据类型正确性

#### 2.1.2 数据解析要求
- 自动识别表头
- 支持中英文字段名
- 数据清洗：去除空行、格式化数值
- 错误提示：对无效数据给出明确提示

### 2.2 可视化界面功能
#### 2.2.1 集装箱视图
- 2D俯视图展示（推荐）或3D视图
- 按比例显示集装箱尺寸（11800mm × 2300mm）
- 网格化布局，便于精确放置
- 显示已占用和可用空间

#### 2.2.2 箱子展示
- 按实际比例显示箱子尺寸
- 每个箱子显示信息：
  - 箱号（ID）
  - 尺寸（长×宽）
  - 重量
- 使用不同颜色区分不同箱子
- 支持箱子选中高亮

### 2.3 交互操作功能
#### 2.3.1 拖放操作
- 从待装载列表拖拽箱子到集装箱
- 支持已放置箱子的位置调整
- 实时碰撞检测，防止重叠
- 支持撤销/重做操作

#### 2.3.2 放置辅助
- 自动吸附对齐功能
- 显示放置参考线
- 空间可行性实时检测
- 旋转功能（90度旋转箱子）

### 2.4 重量平衡监控
#### 2.4.1 实时计算显示
- 左右重量差值（限制：< 500kg）
- 前后重量差值（限制：< 2000kg）
- 总重量统计
- 重心位置可视化

#### 2.4.2 警告提示
- 超出限制时的颜色警告（如红色）
- 文字提示具体超限数值
- 建议调整方案

### 2.5 空间利用率分析
#### 2.5.1 利用率计算
- 面积利用率 = (已占用面积 / 总面积) × 100%
- 体积利用率（如果有高度信息）
- 实时更新显示

#### 2.5.2 优化建议
- 剩余空间分析
- 可放置箱子推荐

### 2.6 多集装箱管理
#### 2.6.1 自动检测
- 当前集装箱无法容纳新箱子时自动提示
- 一键创建新集装箱

#### 2.6.2 集装箱切换
- 标签页或列表形式管理多个集装箱
- 显示每个集装箱的装载状态
- 支持在集装箱间移动箱子

### 2.7 数据保存与导出
#### 2.7.1 项目保存
- 保存当前装载方案
- 支持项目文件格式（如.json）
- 自动保存功能
- 加载历史方案

#### 2.7.2 PDF报告生成
- 彩色可视化装载图
- 详细装载清单
- 重量分布分析
- 空间利用率统计
- 装载建议和注意事项

## 3. 非功能需求

### 3.1 性能要求
- 支持至少100个箱子的实时操作
- 界面响应时间 < 200ms
- PDF生成时间 < 10秒

### 3.2 可用性要求
- 直观的用户界面设计
- 支持快捷键操作
- 提供操作帮助和提示
- 支持中文界面

### 3.3 兼容性要求
- 支持Windows、macOS、Linux
- Python 3.8+
- 分辨率自适应（最低1366×768）

### 3.4 部署要求
- 支持打包为独立的Windows可执行文件（.exe）
- 无需Python环境即可运行
- 包含所有必要的依赖库
- 安装包大小控制在200MB以内

## 4. 技术架构建议

### 4.1 推荐技术栈
- **GUI框架**: PyQt5/PyQt6 或 Tkinter + CustomTkinter
- **数据处理**: pandas（Excel读取）、numpy（计算）
- **可视化**: matplotlib 或 PyQtGraph
- **PDF生成**: ReportLab 或 PyPDF2
- **数据存储**: JSON 或 SQLite
- **打包工具**: PyInstaller 或 cx_Freeze

### 4.2 系统架构
```
├── 表现层（GUI）
│   ├── 主窗口
│   ├── 集装箱视图
│   ├── 控制面板
│   └── 状态栏
├── 业务逻辑层
│   ├── 装载算法
│   ├── 重量计算
│   ├── 空间管理
│   └── 数据验证
└── 数据层
    ├── Excel解析
    ├── 项目存储
    └── PDF生成
```

## 5. 用户界面设计建议

### 5.1 主界面布局
- **顶部菜单栏**: 文件、编辑、视图、工具、帮助
- **左侧面板**: 待装载箱子列表
- **中央区域**: 集装箱可视化视图
- **右侧面板**: 属性面板和统计信息
- **底部状态栏**: 实时提示和警告信息

### 5.2 配色方案
- 集装箱背景：浅灰色网格
- 已放置箱子：使用不同的鲜艳颜色
- 警告状态：红色
- 正常状态：绿色
- 提示信息：蓝色

## 6. 开发计划建议

### 6.1 开发阶段
1. **第一阶段**（2周）：基础框架和数据导入
2. **第二阶段**（3周）：可视化界面和基本交互
3. **第三阶段**（2周）：重量计算和平衡监控
4. **第四阶段**（2周）：多集装箱管理和优化
5. **第五阶段**（1周）：报告生成和测试完善
6. **第六阶段**（1周）：Windows打包和部署准备

### 6.2 测试要求
- 单元测试：核心算法测试
- 集成测试：模块间交互测试
- 用户测试：真实场景测试
- 性能测试：大数据量测试

## 7. 风险评估与应对

### 7.1 技术风险
- **风险**：复杂的空间算法实现
- **应对**：采用成熟的装箱算法库或简化初版算法

### 7.2 用户体验风险
- **风险**：界面操作复杂
- **应对**：进行用户调研，迭代优化界面

### 7.3 性能风险
- **风险**：大量箱子时性能下降
- **应对**：优化渲染算法，采用虚拟化技术

## 8. 扩展功能建议

### 8.1 自动装载算法
- 基于遗传算法的自动优化
- 一键自动布局功能

### 8.2 3D可视化
- 提供3D视角查看
- 支持箱子堆叠（如有高度信息）

### 8.3 数据分析
- 历史装载方案对比
- 装载效率趋势分析

### 8.4 协作功能
- 多用户协同装载
- 方案分享和评审

## 10. Windows可执行文件打包方案

### 10.1 打包工具选择
#### 10.1.1 PyInstaller（推荐）
- **优点**：
  - 支持大多数Python库
  - 可创建单文件可执行程序
  - 配置灵活，社区支持好
- **基本使用**：
  ```bash
  pyinstaller --onefile --windowed --icon=app.ico main.py
  ```

#### 10.1.2 cx_Freeze（备选）
- **优点**：
  - 跨平台支持好
  - 打包速度较快
- **缺点**：
  - 配置相对复杂
  - 某些库支持可能有问题

### 10.2 打包配置要求
#### 10.2.1 资源文件处理
- 图标文件（.ico）
- 配置文件
- 字体文件
- 示例数据文件
- 使用`--add-data`参数包含资源

#### 10.2.2 依赖库处理
- 确保所有第三方库都被正确包含
- 特别注意：
  - pandas需要包含numpy依赖
  - PyQt需要包含Qt运行时
  - matplotlib需要包含后端渲染库

### 10.3 打包优化策略
#### 10.3.1 减小文件大小
- 使用UPX压缩（可选）
- 排除不必要的模块
- 优化导入，避免引入整个库

#### 10.3.2 启动速度优化
- 延迟导入大型库
- 使用多进程分离UI和计算
- 预编译Python文件为.pyc

### 10.4 安装程序制作
#### 10.4.1 Inno Setup（推荐）
- 创建专业的Windows安装程序
- 支持：
  - 安装向导界面
  - 开始菜单快捷方式
  - 桌面快捷方式
  - 卸载程序
  - 注册表项

#### 10.4.2 NSIS（备选）
- 更灵活的脚本控制
- 较小的安装包体积

### 10.5 打包测试要求
#### 10.5.1 兼容性测试
- Windows 7/8/10/11 各版本测试
- 32位和64位系统测试
- 不同分辨率测试

#### 10.5.2 功能测试
- 所有功能模块正常运行
- 文件读写权限正常
- PDF导出功能正常
- 无需管理员权限即可运行

### 10.6 分发注意事项
#### 10.6.1 数字签名
- 建议对exe文件进行数字签名
- 避免Windows Defender误报
- 提升用户信任度

#### 10.6.2 版本管理
- 在程序中内置版本号
- 支持自动更新检查
- 保留多个版本的兼容性

### 10.7 常见问题预防
#### 10.7.1 防病毒软件误报
- 提交到主流杀毒软件白名单
- 避免使用可疑的打包选项
- 保持代码透明度

#### 10.7.2 依赖问题
- 静态链接所有依赖
- 提供详细的错误日志
- 包含依赖检查工具
